- hosts:
    - all
  remote_user: opc
  become: yes
  roles:
    - rhel_common
  
- hosts:
    - tag_name=pyrokar
  remote_user: opc
  become: yes
  roles:
    - haproxy
  vars:
    haproxy_conf: pyrokar_haproxy.cfg
    certbot_domains:
      - domain: wiki.dapo.tech
        expiry_notification_email: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66616239346662616333653462363262376239306565663731383836393666316564313834343163
          3937343035316565336264643332643230336165383139300a313161653838393966313030373538
          61306466333565353432346363613338343535373935653736356466373662323830303362393065
          3763316263323136310a366538363633376665353330623461336363646131396664343964346434
          66663939616334613263653030303065623666633062306162393463393139633437
    cloudflare_api_token: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          38393530626630643832303438643062383738326638636265366465386537316134653533313930
          3836646465396664643463626365373735643737326364370a396462633434613233623534323561
          37313063356262393535333133333966623963336433623736653564363061646330373164623265
          6232626436373333310a393535393464663431646332313861306630666663383539616335373963
          66383539356363313561346634353737376163306165326234663932313338376566336638323635
          6639326638643637303036363436376638376531366564356134

 

- hosts:
    - tag_name=serpentes
  remote_user: opc
  become: yes
  roles:
    - lvm
    - fstab
    - docker
  vars:
    compose_file: serpentes.yaml
    vgs:
      - vg: storage
        pvs:
          - /dev/sdb
    lvs:
      - lv: wikijs
        vg: storage
        size: 10g
        fstype: ext4

    fstab_mounts:
      - target: /var/lib/wikijs
        device: /dev/storage/wikijs
    wikijs_postgres_password: !vault |
                                        $ANSIBLE_VAULT;1.1;AES256
                                        30376265383264366664333936333633343837626439386365393331303239616138356662616435
                                        3238393931343936636365376362613930343235656233310a633431643430313866383631393635
                                        31336563366137613366393162306537353331353561343531363631663839323837383261613264
                                        6264346263663732330a363535643461353738333865623138653463366632353331656566656239
                                        37393966363863623231663062633530343664366331656662333839636231363461306162336139
                                        39313638613634616530626564616630643930663264373537326464343231303161656239633132
                                        393064346138343837653462383538366136

